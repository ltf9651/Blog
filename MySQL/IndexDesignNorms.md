## 索引设计规范

#### MySQL的查询优化器在查询时选择如何优化查询时会根据统一信息对每一个可能用到的索引进行评估，生成最佳查询计划。过多的索引会影响优化器生成查询计划的时间，降低查询性能

- 单表索引数量尽量不超过 **5** 个
  - 索引可以增加查询效率，但是也会降低`update`，`delete`效率
  - 禁止给表中每一列创建单独索引
- 为每张表都设置一个主键
  - 不使用更新频繁的列作为主键
    - 数据存储逻辑顺序的频繁变动会带来大量IO操作，降低数据库性能
  - 不使用多列主键
  - 若不设置主键InnoDB会自动生成一个占6字节的主键，但是此主键性能差
  - 不适用UUID、MD5、HASH、字符串列作为主键
    - 若新插入的列的主键的值小于已存储的数据，会影响InnoDB数据的排序，占用CPU和IO
- 索引的设置
  - `select`，`update`，`delete`语句中`where`从句中的列
  - 包含在`order by`，`group by`，`distinct`中的字段
  - 多表`join`的关联列
  - 区分度最高的放在联合索引最左侧
  - 字段长度小的列放左侧（长度越小存储量大，IO性能好）
  - 使用最频繁的列放左侧
- 对频繁查询优先使用覆盖索引
  - 可以避免Innodb表进行索引的二次查找
  - 可把随机IO变为顺序IO加快效率
- 避免使用外键索引
  - 外键虽然可以保证数据的参照完整性，但会影响性能

- 联合索引（顺序:左 → 右）
```
index(a, b, c)  index(a, b)  index(a) //此设置对a, b冗余
```