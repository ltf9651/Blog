## 懒惰删除

### lazy free
删除指令 `del` 会直接释放内存，但是当删除的对象非常大，会造成单线程卡顿

Redis 引入了`unlink`指令，将删除操作丢给后台线程进行异步回收

执行了`unlink`的对象就无法再被其他指令访问到

### flush
`flushall async` ： 异步清空数据库


### 异步队列
当使用异步指令后，会将这个key的内存回收操作打包成一个任务，塞进异步任务队列，后台线程从队列中取任务。

`unlink`的key较小时就会被立即回收，不延后处理

### AOF Sync
Redis需要每秒一次(可配置)同步AOF日志到磁盘，确保消息尽量不丢失，需要调用sync函数，这个操作会比较耗时，会导致主线程的效率下降，所以Redis也将这个操作移到异步线程来完成。执行AOF Sync操作的线程是一个独立的异步线程，和前面的懒惰删除线程不是一个线程，同样它也有一个属于自己的任务队列，队列里只用来存放AOF Sync任务。



[异步删除细节](https://yq.aliyun.com/articles/205504)