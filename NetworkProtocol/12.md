## CDN

CDN 分为中心节点、曲玉洁蒂娜、边缘节点，数据缓存在离用户最近的位置

1. 访问 www.web.com 时候，在 web.com 这个权威 DNS 服务器上，会设置一个 CNAME 别名，指向另外一个域名 www.web.cdn.com，返回给本地 DNS 服务器
1. 当本地 DNS 服务器拿到这个新的域名时，需要继续解析这个新的域名。这个时候，再访问的就不是 web.com 的权威 DNS 服务器了，而是 web.cdn.com 的权威 DNS 服务器，这是 CDN 自己的权威 DNS 服务器。在这个服务器上，还是会设置一个 CNAME，指向另外一个域名，也即 CDN 网络的全局负载均衡器。
1. 接下来，本地 DNS 服务器去请求 CDN 的全局负载均衡器解析域名，全局负载均衡器会为用户选择一台合适的缓存服务器提供服务，选择的依据包括：
  - 根据用户 IP 地址，判断哪一台服务器距用户最近；
  - 用户所处的运营商；
  - 根据用户所请求的 URL 中携带的内容名称，判断哪一台服务器上有用户所需的内容；
  - 查询各个服务器当前的负载情况，判断哪一台服务器尚有服务能力。
1. 基于以上这些条件，进行综合分析之后，全局负载均衡器会返回一台缓存服务器的 IP 地址
1. 本地 DNS 服务器缓存这个 IP 地址，然后将 IP 返回给客户端，客户端去访问这个边缘节点，下载资源
1. 缓存服务器响应用户请求，将用户所需内容传送到用户终端。如果这台缓存服务器上并没有用户想要的内容，那么这台服务器就要向它的上一级缓存服务器请求内容，直至追溯到网站的源服务器将内容拉到本地

CDN 最擅长的是缓存静态数据，除此之外还可以缓存流媒体数据，这时候要注意使用防盗链。它也支持动态数据的缓存，一种是边缘计算模式，另一种是链路优化模式

边缘计算模式
  - 数据的逻辑计算和存储放在边缘节点，定时从源数据同步存储的数据，然后在边缘进行计算

链路优化
  - 数据在源站生成，数据的下发通过 CDN 的网络对路径进行优化
