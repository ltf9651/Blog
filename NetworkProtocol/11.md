## DNS

DNS 是网络世界的地址簿，可以通过域名查地址

- 根 DNS 服务器 ：返回顶级域 DNS 服务器的 IP 地址
- 顶级域 DNS 服务器：返回权威 DNS 服务器的 IP 地址
- 权威 DNS 服务器 ：返回相应主机的 IP 地址

### 解析流程

1. 电脑客户端发出一个 DNS 请求，询问目标域名的 IP，并发给本地 DNS
1. 本地 DNS 收到请求后在缓存上进行查找，若没找到，本地 DNS 去访问根域名服务器
1. 根 NDS 收到请求后根据后缀（.com、.cn、.net 等）提供顶级域名服务器的地址
1. 本地 DNS 访问顶级域名服务器，顶级域名服务器提供权威 DNS 服务器的地址
1. 本地 DNS 访问权威 DNS 服务器，权威 NDS 查询后将对应的 IP 地址告诉本地 DNS
1. 本地 DNS 将结果返回客户端，客户端与目标建立连接

### 负载均衡

DNS 可做内部负载均衡和全局负载均衡

1. 第一层 GSLB，通过查看请求它的本地 DNS 服务器所在的运营商，就知道用户所在的运营商。假设是移动，通过 CNAME 的方式，通过另一个别名 object.yd.yourcompany.com，告诉本地 DNS 服务器去请求第二层的 GSLB。
2. 第二层 GSLB，通过查看请求它的本地 DNS 服务器所在的地址，就知道用户所在的地理位置，然后将距离用户位置比较近的 Region 里面，六个内部负载均衡（SLB，Server Load Balancer）的地址，返回给本地 DNS 服务器。
3. 本地 DNS 服务器将结果返回给本地 DNS 解析器。
4. 本地 DNS 解析器将结果缓存后，返回给客户端。
5. 客户端开始访问属于相同运营商的距离较近的 Region 1 中的对象存储，当然客户端得到了六个 IP 地址，它可以通过负载均衡的方式，随机或者轮询选择一个可用区进行访问。对象存储一般会有三个备份，从而可以实现对存储读写的负载均衡。

### HTTPDNS

传统的 DNS 有很多问题，例如解析慢、更新不及时。因为缓存、转发、NAT 问题导致客户端误会自己所在的位置和运营商，从而影响流量的调度

HTTPDNS 通过客户端 SDK 和服务端，通过 HTTP 直接调用解析 DNS 的方式，绕过了传统 DNS 的这些缺点，实现了智能的调度
