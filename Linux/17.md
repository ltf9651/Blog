## 进程池和线程池

- 进程池是由服务器预先创建的一组子进程，线程池数量应该和 CPU 数量差不多
- 进程池中的所有子进程都运行着相同的代码，并具有相同的属性
- 当有新任务到来时，主进程通过某种方式选择进程池中的某一个子进程来为之服务
  - 主进程使用算法选择子进程
  - 主进程和所有子进程通过一个共享的工作队列来同步，子进程都睡眠在该工作队列上，当有新任务到来时，主进程将任务添加到工作队列中，唤醒正在等待任务的子进程，只有一个子进程获得新任务的接管权，其他子进程继续睡眠
- 选择好子进程后，主进程告诉目标紫禁城有新任务需要处理，并传递需要的数据

### 处理多客户

- 半同步 / 半反应堆由主进程统一管理监听 socket 和连接 socket
- 半同步 / 半异步和领导者 / 追随者由主进程管理所有监听 socket，子进程分别管理属于自己的连接 socket
