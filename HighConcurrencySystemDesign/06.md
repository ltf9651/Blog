## 池化技术

连接池主要作用：使用预先创建好的对象来减少频繁创建对象的性能开销，节省建立数据库连接的时间

- 如果当前连接数小于最小连接数，则创建新的连接处理数据库请求；
- 如果连接池中有空闲连接则复用空闲连接；
- 如果空闲池中没有连接并且当前连接数小于最大连接数，则创建新的连接处理请求；
- 如果当前连接数已经大于等于最大连接数，则按照配置中设定的时间（C3P0 的连接池配置是 checkoutTimeout）等待旧的连接可用；
- 如果等待超过了这个设定时间则向用户抛出错误。

保证可用性
  - 启动一个线程来定期检测连接池中的连接是否可用，定时发送心跳，发现异常就从池中移除这个连接
  - 获取到连接后先校验连接是否可用，可用再执行 SQL 语句

ThreadPoolExecutor 线程池

 - 如果线程池中的线程数少于 coreThreadCount 时，处理新的任务时会创建新的线程；
 - 如果线程数大于 coreThreadCount 则把任务丢到一个队列里面，由当前空闲的线程执行；
 - 当队列中的任务堆积满了的时候，则继续创建线程，直到达到 maxThreadCount；
 - 当线程数达到 maxTheadCount 时还有新的任务提交，将任务丢弃。

JDK 实现的这个线程池优先把任务放入队列暂存起来，而不是创建更多的线程，线程过多会造成上下文切换，降低任务执行效率
